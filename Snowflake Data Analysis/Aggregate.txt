-- This outputs the VendorID and the difference average, minimum value, maximum value, and total count grouped by VendorID
SELECT VENDOR_ID, AVG((DELIVERY_DATE - FIRST_GR_POSTING_DATE)) AS "TARGET_AVG", MIN((DELIVERY_DATE - FIRST_GR_POSTING_DATE)) AS "TARGET_MIN", MAX((DELIVERY_DATE - FIRST_GR_POSTING_DATE)) AS "TARGET_MAX", COUNT((DELIVERY_DATE - FIRST_GR_POSTING_DATE)) AS "TARGET_COUNT", AVG(NEW_REQUESTED_DELIVERY_DATE - DELIVERY_DATE) AS "REQUESTED_DIFF"
FROM PURCHASE_ORDER_HISTORY
GROUP BY VENDOR_ID
ORDER BY VENDOR_ID ASC;